local _G = {
    ControllerID = 9822837105, -- Ø§Ù„Ø£ÙˆÙ†Ø± Ø§Ù„ÙˆØ­ÙŠØ¯
    CommandCooldown = {} -- Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

-- Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‡Ùˆ Ø§Ù„Ø£ÙˆÙ†Ø±
local function isOwner(player)
    return player.UserId == _G.ControllerID
end

-- Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø§Ø¹Ø¨
local function notifyPlayer(player, message)
    pcall(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ…",
            Text = message,
            Icon = "rbxassetid://0",
            Duration = 5
        })
    end)
end

-- Ø¯Ø§Ù„Ø© Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ø§Ø³Ù…
local function findPlayerByName(name)
    local nameLower = name:lower()
    for _, player in ipairs(Players:GetPlayers()) do
        if player.Name:lower():find(nameLower) or 
           player.DisplayName:lower():find(nameLower) then
            return player
        end
    end
    return nil
end

-- Ø¯Ø§Ù„Ø© Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
local function checkCooldown(player)
    if _G.CommandCooldown[player.UserId] and os.time() - _G.CommandCooldown[player.UserId] < 2 then
        notifyPlayer(player, "â³ Ø§Ù†ØªØ¸Ø± Ø«Ø§Ù†ÙŠØªÙŠÙ† Ø¨ÙŠÙ† ÙƒÙ„ Ø£Ù…Ø±")
        return false
    end
    _G.CommandCooldown[player.UserId] = os.time()
    return true
end

-- ========== Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ØªÙ„ (KILL) ==========
local function killPlayer(targetPlayer, killerName)
    if not targetPlayer or not targetPlayer.Character then
        return false
    end
    
    local humanoid = targetPlayer.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.Health = 0
        print("ðŸ’€ ØªÙ… Ù‚ØªÙ„ "..targetPlayer.Name.." Ø¨ÙˆØ§Ø³Ø·Ø© "..killerName)
        return true
    end
    return false
end

local function killAllPlayers(killerName)
    local players = Players:GetPlayers()
    local killedCount = 0
    
    for _, player in ipairs(players) do
        if player.Character and not isOwner(player) then
            if killPlayer(player, killerName) then
                killedCount = killedCount + 1
            end
        end
    end
    
    print("ðŸ’€ ØªÙ… Ù‚ØªÙ„ "..killedCount.." Ù„Ø§Ø¹Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© "..killerName)
    return killedCount
end

-- ========== Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ù„Ø¨ (BRING) ==========
local function bringPlayer(targetPlayer, bringerName)
    if not targetPlayer or not targetPlayer.Character then
        return false
    end
    
    local bringer = Players:FindFirstChild(bringerName)
    if not bringer or not bringer.Character then
        return false
    end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    local bringerRoot = bringer.Character:FindFirstChild("HumanoidRootPart")
    
    if targetRoot and bringerRoot then
        -- Ø¥Ù„ØºØ§Ø¡ Ø£ÙŠ Ø­Ø±ÙƒØ© Ø³Ø§Ø¨Ù‚Ø©
        targetRoot.Velocity = Vector3.new(0, 0, 0)
        targetRoot.RotVelocity = Vector3.new(0, 0, 0)
        
        -- Ø¬Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø£Ù…Ø§Ù… Ø§Ù„Ø¬Ø§Ù„Ø¨
        local offset = bringerRoot.CFrame.LookVector * 5
        targetRoot.CFrame = bringerRoot.CFrame + offset + Vector3.new(0, 3, 0)
        
        print("ðŸŽ¯ ØªÙ… Ø¬Ù„Ø¨ "..targetPlayer.Name.." Ø¥Ù„Ù‰ "..bringerName)
        return true
    end
    return false
end

local function bringAllPlayers(bringerName)
    local bringer = Players:FindFirstChild(bringerName)
    if not bringer or not bringer.Character then return 0 end
    
    local players = Players:GetPlayers()
    local broughtCount = 0
    
    for i, player in ipairs(players) do
        if player ~= bringer and player.Character then
            if bringPlayer(player, bringerName) then
                broughtCount = broughtCount + 1
                wait(0.3) -- ØªØ£Ø®ÙŠØ± Ø¨ÙŠÙ† ÙƒÙ„ Ø¬Ù„Ø¨
            end
        end
    end
    
    print("ðŸŽ¯ ØªÙ… Ø¬Ù„Ø¨ "..broughtCount.." Ù„Ø§Ø¹Ø¨ Ø¥Ù„Ù‰ "..bringerName)
    return broughtCount
end

-- ========== Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ø±Ø¯ (KICK) ==========
local function kickPlayer(targetPlayer, kickerName)
    if not targetPlayer then return false end
    
    pcall(function()
        targetPlayer:Kick("ðŸš« ØªÙ… Ø·Ø±Ø¯Ùƒ Ø¨ÙˆØ§Ø³Ø·Ø© "..kickerName)
        print("ðŸš« ØªÙ… Ø·Ø±Ø¯ "..targetPlayer.Name.." Ø¨ÙˆØ§Ø³Ø·Ø© "..kickerName)
    end)
    
    return true
end

local function kickAllPlayers(kickerName)
    local players = Players:GetPlayers()
    local kickedCount = 0
    
    for _, player in ipairs(players) do
        if not isOwner(player) then
            if kickPlayer(player, kickerName) then
                kickedCount = kickedCount + 1
            end
        end
    end
    
    print("ðŸš« ØªÙ… Ø·Ø±Ø¯ "..kickedCount.." Ù„Ø§Ø¹Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© "..kickerName)
    return kickedCount
end

-- ========== Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø°Ù (FLING) ==========
local flingConnections = {}

local function flingPlayer(targetPlayer, flingerName)
    if not targetPlayer or not targetPlayer.Character then
        return false
    end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not targetRoot then return false end
    
    -- Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù‚Ø°Ù Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯
    if flingConnections[targetPlayer.UserId] then
        flingConnections[targetPlayer.UserId]:Disconnect()
        flingConnections[targetPlayer.UserId] = nil
    end
    
    -- ØªØ·Ø¨ÙŠÙ‚ Ù‚ÙˆØ© Ù‚Ø°Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
    local flingForce = Instance.new("BodyVelocity")
    flingForce.Velocity = Vector3.new(
        math.random(-500, 500),
        math.random(200, 500),
        math.random(-500, 500)
    )
    flingForce.MaxForce = Vector3.new(10000, 10000, 10000)
    flingForce.Parent = targetRoot
    
    -- Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‚ÙˆØ© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
    delay(3, function()
        if flingForce and flingForce.Parent then
            flingForce:Destroy()
        end
        if flingConnections[targetPlayer.UserId] then
            flingConnections[targetPlayer.UserId]:Disconnect()
            flingConnections[targetPlayer.UserId] = nil
        end
    end)
    
    print("ðŸŒ€ ØªÙ… Ù‚Ø°Ù "..targetPlayer.Name.." Ø¨ÙˆØ§Ø³Ø·Ø© "..flingerName)
    return true
end

local function flingAllPlayers(flingerName)
    local players = Players:GetPlayers()
    local flungCount = 0
    
    for _, player in ipairs(players) do
        if not isOwner(player) then
            if flingPlayer(player, flingerName) then
                flungCount = flungCount + 1
            end
        end
    end
    
    print("ðŸŒ€ ØªÙ… Ù‚Ø°Ù "..flungCount.." Ù„Ø§Ø¹Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© "..flingerName)
    return flungCount
end

-- ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø± ==========
local function processCommand(player, message)
    local command = message:lower()
    
    if not checkCooldown(player) then return end
    
    -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø£ÙˆÙ†Ø±
    if isOwner(player) then
        -- Ø£Ù…Ø± Ø§Ù„Ù‚ØªÙ„
        if command == "!kill all" then
            local count = killAllPlayers(player.Name)
            notifyPlayer(player, "ðŸ’€ ØªÙ… Ù‚ØªÙ„ "..count.." Ù„Ø§Ø¹Ø¨")
            
        elseif command:sub(1, 6) == "!kill " then
            local targetName = command:sub(7)
            if targetName and targetName ~= "" then
                local targetPlayer = findPlayerByName(targetName)
                if targetPlayer then
                    if killPlayer(targetPlayer, player.Name) then
                        notifyPlayer(player, "ðŸ’€ ØªÙ… Ù‚ØªÙ„ "..targetPlayer.Name)
                    else
                        notifyPlayer(player, "âŒ ÙØ´Ù„ ÙÙŠ Ù‚ØªÙ„ "..targetPlayer.Name)
                    end
                else
                    notifyPlayer(player, "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰: "..targetName)
                end
            end
            
        -- Ø£Ù…Ø± Ø§Ù„Ø¬Ù„Ø¨
        elseif command == "!bring all" then
            local count = bringAllPlayers(player.Name)
            notifyPlayer(player, "ðŸŽ¯ ØªÙ… Ø¬Ù„Ø¨ "..count.." Ù„Ø§Ø¹Ø¨")
            
        elseif command:sub(1, 7) == "!bring " then
            local targetName = command:sub(8)
            if targetName and targetName ~= "" then
                local targetPlayer = findPlayerByName(targetName)
                if targetPlayer then
                    if bringPlayer(targetPlayer, player.Name) then
                        notifyPlayer(player, "ðŸŽ¯ ØªÙ… Ø¬Ù„Ø¨ "..targetPlayer.Name)
                    else
                        notifyPlayer(player, "âŒ ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ "..targetPlayer.Name)
                    end
                else
                    notifyPlayer(player, "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰: "..targetName)
                end
            end
            
        -- Ø£Ù…Ø± Ø§Ù„Ø·Ø±Ø¯
        elseif command == "!kick all" then
            local count = kickAllPlayers(player.Name)
            notifyPlayer(player, "ðŸš« ØªÙ… Ø·Ø±Ø¯ "..count.." Ù„Ø§Ø¹Ø¨")
            
        elseif command:sub(1, 6) == "!kick " then
            local targetName = command:sub(7)
            if targetName and targetName ~= "" then
                local targetPlayer = findPlayerByName(targetName)
                if targetPlayer then
                    if kickPlayer(targetPlayer, player.Name) then
                        notifyPlayer(player, "ðŸš« ØªÙ… Ø·Ø±Ø¯ "..targetPlayer.Name)
                    end
                else
                    notifyPlayer(player, "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰: "..targetName)
                end
            end
            
        -- Ø£Ù…Ø± Ø§Ù„Ù‚Ø°Ù
        elseif command == "!fling all" then
            local count = flingAllPlayers(player.Name)
            notifyPlayer(player, "ðŸŒ€ ØªÙ… Ù‚Ø°Ù "..count.." Ù„Ø§Ø¹Ø¨")
            
        elseif command:sub(1, 7) == "!fling " then
            local targetName = command:sub(8)
            if targetName and targetName ~= "" then
                local targetPlayer = findPlayerByName(targetName)
                if targetPlayer then
                    if flingPlayer(targetPlayer, player.Name) then
                        notifyPlayer(player, "ðŸŒ€ ØªÙ… Ù‚Ø°Ù "..targetPlayer.Name)
                    else
                        notifyPlayer(player, "âŒ ÙØ´Ù„ ÙÙŠ Ù‚Ø°Ù "..targetPlayer.Name)
                    end
                else
                    notifyPlayer(player, "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰: "..targetName)
                end
            end
            
        -- Ù…Ø³Ø§Ø¹Ø¯Ø©
        elseif command == "!help" then
            notifyPlayer(player, "ðŸŽ® Ø§Ù„Ø£ÙˆØ§Ù…Ø±: !kill, !bring, !kick, !fling + [all/Ø§Ø³Ù…]")
        end
        
    -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø§Ø¹Ø¨ Ø¹Ø§Ø¯ÙŠ
    else
        -- Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ† ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø¹Ù„Ù‰ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø¹ÙŠÙ†ÙŠÙ† ÙÙ‚Ø·
        if command:sub(1, 6) == "!kill " then
            local targetName = command:sub(7)
            local targetPlayer = findPlayerByName(targetName)
            if targetPlayer and targetPlayer ~= player then
                if killPlayer(targetPlayer, player.Name) then
                    notifyPlayer(player, "ðŸ’€ ØªÙ… Ù‚ØªÙ„ "..targetPlayer.Name)
                end
            end
            
        elseif command:sub(1, 7) == "!bring " then
            local targetName = command:sub(8)
            local targetPlayer = findPlayerByName(targetName)
            if targetPlayer and targetPlayer ~= player then
                if bringPlayer(targetPlayer, player.Name) then
                    notifyPlayer(player, "ðŸŽ¯ ØªÙ… Ø¬Ù„Ø¨ "..targetPlayer.Name)
                end
            end
            
        elseif command:sub(1, 7) == "!fling " then
            local targetName = command:sub(8)
            local targetPlayer = findPlayerByName(targetName)
            if targetPlayer and targetPlayer ~= player then
                if flingPlayer(targetPlayer, player.Name) then
                    notifyPlayer(player, "ðŸŒ€ ØªÙ… Ù‚Ø°Ù "..targetPlayer.Name)
                end
            end
            
        -- Ø§Ù„Ø·Ø±Ø¯ Ù…Ù…Ù†ÙˆØ¹ Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ†
        elseif command:sub(1, 6) == "!kick " or command == "!kick all" then
            notifyPlayer(player, "âŒ ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ùƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù…Ø± Ø§Ù„Ø·Ø±Ø¯")
            
        -- Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© Ù…Ù…Ù†ÙˆØ¹Ø© Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ†
        elseif command:endswith(" all") then
            notifyPlayer(player, "âŒ ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ùƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹")
        end
    end
end

-- ========== Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… ==========
local function monitorPlayer(player)
    player.Chatted:Connect(function(message)
        if message:lower():sub(1, 1) == "!" then
            processCommand(player, message)
        end
    end)
end

local function startMonitoring()
    for _, player in ipairs(Players:GetPlayers()) do
        monitorPlayer(player)
    end
end

Players.PlayerAdded:Connect(function(player)
    monitorPlayer(player)
    if isOwner(player) then
        print("â­ Ø§Ù„Ø£ÙˆÙ†Ø± Ø¯Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©! (9822837105)")
        notifyPlayer(player, "ðŸŽ® Ø£Ù†Øª Ø§Ù„Ø£ÙˆÙ†Ø±! Ø§Ø³ØªØ®Ø¯Ù… !help Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©")
    end
end)

-- Ø§Ù„Ø¨Ø¯Ø¡
print("ðŸŽ® Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù…ÙØ¹Ù„!")
print("ðŸŽ® Ø§Ù„Ø£ÙˆÙ†Ø± Ø§Ù„ÙˆØ­ÙŠØ¯: 9822837105")

startMonitoring()

-- Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø£ÙˆÙ†Ø±
local localPlayer = Players.LocalPlayer
if localPlayer and isOwner(localPlayer) then
    notifyPlayer(localPlayer, "ðŸŽ® Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø¬Ø§Ù‡Ø²! Ø§Ø³ØªØ®Ø¯Ù… !help")
end

return {
    -- Ø¯ÙˆØ§Ù„ ÙŠØ¯ÙˆÙŠØ©
    kill = killPlayer,
    bring = bringPlayer,
    kick = kickPlayer,
    fling = flingPlayer,
    
    -- Ø¯ÙˆØ§Ù„ Ø¬Ù…Ø§Ø¹ÙŠØ©
    killAll = killAllPlayers,
    bringAll = bringAllPlayers,
    kickAll = kickAllPlayers,
    flingAll = flingAllPlayers,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
    isOwner = isOwner,
    getInfo = function()
        return {
            OwnerID = _G.ControllerID,
            TotalPlayers = #Players:GetPlayers(),
            IsOwner = isOwner(Players.LocalPlayer)
        }
    end
}
